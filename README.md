# pr_09
## Практическая работа 9. Геопространственный анализ. 
## Цель:
Определение ближайшего дилерского центра для каждого клиента.
Маркетологи компании пытаются повысить вовлеченность клиентов,
необходимо им помочь найти ближайший дилерский центр.
Разработчикам продукта также интересно знать, каково среднее
расстояние между каждым клиентом и ближайшим к нему дилерским
центром.

## Задачи:
1. Проверить наличие геопространственных данных в базе данных.
2. Создать временную таблицу с координатами долготы и широты для каждого клиента.
3. Создать аналогичную таблицу для каждого дилерского центра.
4. Соединить эти таблицы, чтобы рассчитать расстояние от каждого клиента до каждого
дилерского центра (в киллометрах).
5. Определить ближайший дилерский центр для каждого клиента.
6. Провести выгрузку полученного результата из временной таблицы в CSV.
7. Построить карту клиентов и сервисных центров в облачной визуализации Yandex DataLence.
8. Удалить временные таблицы.

## Выполнение практической работы

## Задание 1. Создать временную таблицу с координатами долготы и широты для каждого клиента.

````
CREATE TEMP TABLE customer_points AS (
SELECT
customer_id,
point(longitude, latitude) AS lng_lat_point
FROM customers
WHERE longitude IS NOT NULL
AND latitude IS NOT NULL
);
````
## Результат
![image](https://github.com/user-attachments/assets/938e4bfe-b571-461a-9fec-92f2a4d756fc)

Проверим данные
````
SELECT * FROM customer_points;
````
## Результат
![image](https://github.com/user-attachments/assets/0d43ff9f-1cb8-44ed-bf48-824738f3d09e)


## Задание 3. Теперь нужно соединить эти таблицы, чтобы рассчитать расстояние от каждого клиента до каждого дилерского центра (в киллометрах).
````
SELECT * FROM customer_points;
CREATE TEMP TABLE dealership_points AS (
SELECT
dealership_id,
point(longitude, latitude) AS lng_lat_point
FROM dealerships
);
SELECT * FROM dealership_points;
````
## Результат
![image](https://github.com/user-attachments/assets/25ba20ec-d762-4d2e-a580-fe6893f2c839)

Проверим данные
````
SELECT * FROM customer_dealership_distance;
````
## Результат
![image](https://github.com/user-attachments/assets/21b0a44d-e22a-4d4e-8ee6-979980c3cf07)


## Задание 4. Объединить эти таблицы, чтобы рассчитать расстояние от каждого клиента до каждого дилерского центра
````

````

## Результат

## Задание 5.
````
````
## Результат



## Задание 6.  
````

````

## Результат

## Выводы
